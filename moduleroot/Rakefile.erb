<%
def requires(item)
  if item.is_a? String
    line = "require '#{item}'"
  elsif item.is_a? Hash
    line = "require '#{item['require']}'" unless item['require'].nil?
    line = "#{line} if #{item['conditional']}" unless item['require'].nil? and item['conditional'].nil?
  end
  line
end
-%>
require 'puppetlabs_spec_helper/rake_tasks'
require 'puppet-syntax/tasks/puppet-syntax'
require 'puppet_blacksmith/rake_tasks' if Bundler.rubygems.find_name('puppet-blacksmith').any?
require 'github_changelog_generator/task' if Bundler.rubygems.find_name('github_changelog_generator').any?
require 'puppet-strings/tasks' if Bundler.rubygems.find_name('puppet-strings').any?
<% if ! @configs['requires'].nil? -%>
<%   @configs['requires'].each do |item| -%>
<%= requires(item) %>
<%   end -%>
<% end -%>
<% if ! @configs['imports'].nil? %>
<%   @configs['imports'].each do |item| -%>
import '<%= item %>'
<%   end -%>
<% end -%>

<% checks = @configs['default_disabled_lint_checks'] + ( @configs['extra_disabled_lint_checks'] || [] ) -%>
<% checks.each do |check| -%>
PuppetLint.configuration.send('disable_<%= check %>')
<% end -%>
<% checks = @configs['default_lint_checks'] + ( @configs['extra_lint_checks'] || [] ) -%>
<% checks.each do |check| -%>
PuppetLint.configuration.send('<%= check %>')
<% end -%>

create_gch_task(<%= changelog_user.inspect %>, <%= changelog_project.inspect %>, <%= changelog_since_tag.inspect %>)

<%- [@configs['extras']].flatten.compact.each do |line| -%>
<%= line %>
<%- end -%>
